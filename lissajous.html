<!DOCTYPE html>
<html>
	<head>
		<style>
      canvas {
        margin: 40px 0px 0px 40px;
        border: 1px solid;
      }
    </style>
    <script src="colors.js"></script>
	</head>
	<body>
    <canvas id="canvas" height="500" width="500"></canvas>
    <script>
      var canvas = document.getElementById('canvas');
      var ratio = window.devicePixelRatio;

      var oldWidth = canvas.width;
      var oldHeight = canvas.height;

      var width = canvas.width = oldWidth * ratio;
      var height = canvas.height = oldHeight * ratio;

      canvas.style.width = oldWidth + 'px';
      canvas.style.height = oldHeight + 'px';


      var halfWidth = width >> ratio;
      var halfHeight = height >> ratio;
        
      var scaledRatio = ratio * 3.5;  
      var AMPLITUDE = (height / scaledRatio) < (width / scaledRatio) ? height / scaledRatio : width / scaledRatio;
      var SLASHED_ZERO = Math.PI / 180;
      var SLASHED_ZERO_B = Math.PI / 2
      var PI_2 = Math.PI*0.05;

      var a = 3;
      var b = 4;


      function Damper() {
        // Euler's constant
        var E = Math.E;

        // reduce curve over time;
        var damping = 0.004;

        this.getDamping = function() {
          return damping;
        };

        this.setDamping = function(num) {
          damping = num;
        };

        dampen = function(value, t) {
          return Math.pow(E, (-this.getDamping * t)) * value;
        }
      }


      var lissajous = function(a,b,t, amplitude) {
        var vector = {
          x: null,
          y: null
        };

        // multiplying and diving these outputs changes the height and width of the curve
        vector.x = (AMPLITUDE * Math.sin(a * t + SLASHED_ZERO));
        vector.y = (AMPLITUDE * Math.sin(b * t));

        return vector;
      };

      var drawArc = function(startVector, endVector, offsetVector) {
        x = endVector.x;
        y = endVector.y;
        hw = halfWidth;
        hh = halfHeight;

        ctx.beginPath();
        if (startVector) {
          ctx.moveTo(startVector.x + hw, startVector.y + hh);
        }

        if (offsetVector) {
          hw = offsetVector.x
          hh = offsetVector.y
        }

        ctx.arcTo(x + hw, y + hh, radius, 0, PI_2, false);
        ctx.closePath();
        ctx.strokeStyle = LJColor.getDirectionalColor(x, y);
        ctx.stroke();
      };


      var ctx = canvas.getContext('2d');
      ctx.scale(ratio, ratio);
      

      // control line thickness. lower is thinner
      var radius = 1;
      
      var t = 0;
      
      var vector = {x: 0, y: 0};
      var lastVector = null;

      var draw = function() {
        t += 1;
        
        lastVector = vector;
        vector = lissajous(a,b,t);
        

        drawArc(lastVector, vector);
        drawArc(lastVector, vector, {x: halfWidth - 20, y: halfHeight - 20});

        if (t <= 360) {
          window.requestAnimationFrame(draw);
        }
      };

      window.requestAnimationFrame(draw);
      

      /* we need 
        
        Start X
        Start Y
        A - x curve number
        B - y curve number
        amplitude - variable
        radius - variable
        damping - variable, switchable on both x and y
        time - speed (or how clear the line is)
        start degree - how chunky the line is

        !also! store the last vector to draw the line?
      */
      // for (var t = 0; t <= 360; t += 0.1) {
      //   var vector = lissajous(a,b,t);
      //   drawArc(vector);
      // }
    </script>
	</body>
</html>