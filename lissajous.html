<!DOCTYPE html>
<html>
	<head>
		<style>
      canvas {
        margin: 40px 0px 0px 40px;
        border: 1px solid;
      }
    </style>
    <script src="colors.js"></script>
	</head>
	<body>
    <canvas id="canvas" height="500" width="500"></canvas>
    <script>
      function Canvas(el) {
        this.canvas = document.querySelector(el);
        this.ctx = null;
        this.halfWidth = null;
        this.halfHeight = null;

        this._init();
      }

      Canvas.prototype.drawArc = function(start, end, radius) {
        var x = end.x;
        var y = end.y;
        var hw = this.halfWidth;
        var hh = this.halfHeight;

        var ctx = this.ctx;

        ctx.beginPath();

        if (start) {
          ctx.moveTo(start.x + hw, start.y + hh);
        }

        ctx.arcTo(x + hw, y + hh, radius, 0, PI_2, false);
        ctx.closePath();
        ctx.strokeStyle = LJColor.getDirectionalColor(x, y);
        ctx.stroke();
      };

      Canvas.prototype._init = function() {
        if (!'getContext' in this.canvas) {
          alert('Your browser doesnt support this.')
        }

        this.ctx = this.canvas.getContext('2d');

        // Scale for retina screens
        this._scale();

        this.halfWidth = this.canvas.width / 2;
        this.halfHeight = this.canvas.height / 2;

      };

      Canvas.prototype._scale = function() {
        var scalingRatio = window.devicePixelRatio;

        // Wer are on a standard res screen and dont need to scale.
        if (scalingRatio === 1) {
          return;
        }

        var oldWidth = this.canvas.width;
        var oldHeight = this.canvas.height;

        this.canvas.width = oldWidth * scalingRatio;
        this.canvas.height = oldHeight * scalingRatio;

        this.canvas.style.width = oldWidth + 'px';
        this.canvas.style.height = oldHeight + 'px';

        this.ctx.scale(scalingRatio, scalingRatio);
      };

      var canvas = new Canvas('#canvas');
        
      var scaledRatio = 2.5;



      var AMPLITUDE = (canvas.canvas.height / scaledRatio) < (canvas.canvas.width / scaledRatio) ? canvas.canvas.height / scaledRatio : canvas.canvas.width / scaledRatio;
console.log(AMPLITUDE)
      var SLASHED_ZERO = Math.PI / 180;
      var SLASHED_ZERO_B = Math.PI / 2
      var PI_2 = Math.PI * 2;

      var a = 3;
      var b = 4;


      function Damper() {
        // Euler's constant
        var E = Math.E;

        // reduce curve over time;
        var damping = 0.004;

        this.getDamping = function() {
          return damping;
        };

        this.setDamping = function(num) {
          damping = num;
        };

        this.dampen = function(value, t) {
          t = t || 0;
          value = value || 0;

          return Math.pow(E, (-this.getDamping * t)) * value;
        };
      }


      var lissajous = function(a,b,t, amplitude) {
        var vector = {
          x: null,
          y: null
        };

        // multiplying and diving these outputs changes the height and width of the curve
        vector.x = (AMPLITUDE * Math.sin(a * t * SLASHED_ZERO));
        vector.y = (AMPLITUDE * Math.sin(b * t * SLASHED_ZERO));

        return vector;
      };


      // control line thickness. lower is thinner
      var radius = 1;
      
      var t = 0;
      
      var vector = {x: 0, y: 0};
      var lastVector = null;

      var draw = function() {
        t += 1;
        
        lastVector = vector;
        vector = lissajous(a,b,t);
        

        canvas.drawArc(lastVector, vector, radius);

        if (t <= 360) {
          window.requestAnimationFrame(draw);
        }
      };

      window.requestAnimationFrame(draw);
      

      /* we need 
        
        Start X
        Start Y
        A - x curve number
        B - y curve number
        amplitude - variable
        radius - variable
        damping - variable, switchable on both x and y
        time - speed (or how clear the line is)
        start degree - how chunky the line is

        !also! store the last vector to draw the line?
      */
      // for (var t = 0; t <= 360; t += 0.1) {
      //   var vector = lissajous(a,b,t);
      //   drawArc(vector);
      // }
    </script>
	</body>
</html>